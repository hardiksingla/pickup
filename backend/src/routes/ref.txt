def get_all_orders(refresh_all=True):
    if refresh_all == False and os.path.exists('../all_orders.json'):
        orders = pd.read_json('../all_orders.json')
        last = orders['id'].iloc[-1]
    else:
        orders = pd.DataFrame()
        last = 0

    print("Reading orders data")
    while True:
        url = BASE_URL + f"orders.json?limit=250&since_id={last}&status=any"

        if orders.empty:
            print(f"    Reading from the beginning")
        else:
            print(f"    Read from: {orders['name'].iloc[-1]}")
        
        response = requests.request('GET', url)
        df = pd.DataFrame(response.json()['orders'])
        if df.empty == False:
            orders = pd.concat([orders,df], ignore_index=True)
        
        last = orders['id'].iloc[-1]
        if len(df) < 250:
            break
    
    orders.to_json('../all_orders.json', orient='records')
    orders.to_csv('../all_orders.csv', index=False) # this is just for personal view
    return orders